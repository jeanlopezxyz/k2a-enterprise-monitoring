# K2A Enterprise Monitoring Agent
apiVersion: kagent.dev/v1alpha2
kind: Agent
metadata:
  name: k2a-enterprise-monitoring
  namespace: kagent
  labels:
    app.kubernetes.io/name: k2a-enterprise-monitoring
    app.kubernetes.io/part-of: k2a-enterprise-monitoring
spec:
  declarative:
    modelConfig: default-model-config
    systemMessage: |
      You are K2A, an AI agent for Kubernetes enterprise monitoring.

      Use your tools to:
      - Query Prometheus metrics with prometheus_query, prometheus_query_range
      - Check AlertManager alerts with alertmanager_alerts, alertmanager_alert_groups
      - Search Red Hat Knowledge Base with kb_search, kb_get_article
      - Manage support cases with case_create, case_get, case_list

      Always use the available tools to get real data before responding.
      When asked about alerts, use alertmanager_alerts or prometheus_alerts.
      When asked about metrics, use prometheus_query or prometheus_query_range.
    tools:
    - type: McpServer
      mcpServer:
        apiGroup: kagent.dev
        kind: RemoteMCPServer
        name: prometheus-mcp-server
        toolNames:
        - prometheus_query
        - prometheus_query_range
        - prometheus_alerts
        - prometheus_rules
        - prometheus_targets
        - prometheus_metadata
        - prometheus_health
        - prometheus_series
    - type: McpServer
      mcpServer:
        apiGroup: kagent.dev
        kind: RemoteMCPServer
        name: alertmanager-mcp-server
        toolNames:
        - alertmanager_alerts
        - alertmanager_alert_groups
        - alertmanager_silences
        - alertmanager_create_silence
        - alertmanager_delete_silence
        - alertmanager_silence_alert
        - alertmanager_receivers
        - alertmanager_status
        - alertmanager_health
    - type: McpServer
      mcpServer:
        apiGroup: kagent.dev
        kind: RemoteMCPServer
        name: redhat-cases-mcp-server
        toolNames:
        - kb_search
        - kb_get_article
        - case_create
        - case_get
        - case_add_comment
        - case_list
        - case_escalate
        - redhat_health
    a2aConfig:
      skills:
      - id: alert-monitoring
        name: Alert Monitoring
        description: Monitor and analyze alerts from Prometheus and AlertManager
        examples:
        - What alerts are currently firing?
        - Show me critical alerts
        tags:
        - alerts
        - monitoring
      - id: metrics-analysis
        name: Metrics Analysis
        description: Query and analyze Prometheus metrics
        examples:
        - What is the CPU usage?
        - Show memory usage
        tags:
        - metrics
        - prometheus
      - id: redhat-support
        name: Red Hat Support
        description: Search Red Hat KB and manage support cases
        examples:
        - Search for OOMKilled errors
        - Create a support case
        tags:
        - redhat
        - kb
        - support
    deployment:
      resources:
        requests:
          cpu: 100m
          memory: 256Mi
        limits:
          cpu: 1000m
          memory: 1Gi
