# K2A Enterprise Monitoring - Kagent Base Kustomization
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

metadata:
  name: k2a-kagent-base

namespace: k2a-monitoring

# Common labels applied to all resources
commonLabels:
  app.kubernetes.io/name: k2a-monitoring
  app.kubernetes.io/part-of: k2a-enterprise
  app.kubernetes.io/managed-by: kustomize

# Common annotations
commonAnnotations:
  k2a.io/component: kagent

# Resources to include
resources:
  - namespace.yaml
  - secrets.yaml

# Helm chart configuration
helmCharts:
  - name: kagent
    repo: oci://ghcr.io/kagent-dev/kagent/helm
    version: "0.1.0"  # Update to latest version
    releaseName: k2a-kagent
    namespace: k2a-monitoring
    valuesFile: values.yaml
    includeCRDs: true

# ConfigMap generator for additional configuration
configMapGenerator:
  - name: k2a-agent-config
    literals:
      - CLUSTER_NAME=k2a-cluster
      - ENVIRONMENT=base
      - LOG_LEVEL=info

# Patches for customization
patches:
  # Add OpenShift-specific annotations
  - patch: |-
      - op: add
        path: /metadata/annotations/openshift.io~1description
        value: "K2A Enterprise Monitoring with Kagent AI Agent"
    target:
      kind: Namespace
      name: k2a-monitoring
